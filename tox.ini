[tox]
envlist = py37, pep8, docs
minversion = 2.0
skipsdist = True

[testenv]
deps = -r{toxinidir}/requirements.txt
       -r{toxinidir}/test-requirements.txt

passenv = SPLUNK_AUTH_HOST
          SPLUNK_HOST
          SPLUNK_API_HOST
          SPLUNK_APP_HOST
          SPLUNK_APP_CLIENT_ID
          SPLUNK_APP_SERVER
          SPLUNK_USERNAME
          SPLUNK_PASSWORD
          SPLUNK_TENANT

basepython = python3
commands = pytest

[testenv:docs]
deps = sphinx >= 1.7.5, < 2
       sphinxcontrib-apidoc>=0.2.0


commands =
  rm -rf doc/build doc/source/reference/api
  sphinx-build -W -b html doc/source doc/build/html

[testenv:pep8]
basepython = python3
commands = flake8

[flake8]
enable-extensions = H106,H203,H904
ignore = H202,H405,H501
show-source = True
exclude=.venv,.git,.tox,dist,doc,*lib/python*,*egg,build